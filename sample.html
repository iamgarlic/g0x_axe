val sample = """<!DOCTYPE html>
<html>
<head>
<title>三年甲班成績單</title>
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
</head>
<body>
<h1>三年甲班成績單</h1>
<table class="table">
    <tr>
      <td>姓名</td>
      <td>國語</td>
      <td>數學</td>
      <td>自然</td>
      <td>社會</td>
      <td>健康教育</td>
    </tr>       
    <tr>
      <td>楊小旭</td>
      <td>92</td>
      <td>72</td>
      <td>55</td>
      <td>63</td>
      <td>77</td>
    </tr>
    <tr>
      <td>陳政憲</td>
      <td>58</td>
      <td>86</td>
      <td>94</td>
      <td>88</td>
      <td>85</td>
    </tr>
    </table>
</body>
</html>""".replaceAll("""\n""", "") //.replaceAll("""\s""", "")

val xmlRegEx = """(.*)<table class="table">(.*)</table>.*""".r
val xmlRegEx(first, table) = response.body.toString.replaceAll("\n", "")

val tableRegEx = """\s*<tr>\s*<td>(.*)</td>\s*<td>(.*)</td>\s*<td>(.*)</td>\s*<td>(.*)</td>\s*<td>(.*)</td>\s*<td>(.*)</td>\s*</tr>\s*""".r
for (words <- tableRegEx findAllIn table) yield words

val table = """<tr><td>姓名</td><td>國語</td><td>數學</td><td>自然</td><td>社會</td><td>健康教育</td></tr><tr><td>楊小旭</td><td>92</td><td>72</td><td>55</td><td>63</td><td>77</td></tr><tr><td>陳政憲</td><td>58</td><td>86</td><td>94</td><td>88</td><td>85</td></tr>"""
val tableRegEx = """<tr><td>(\w*)</td><td>(\w*)</td><td>(\w*)</td><td>(\w*)</td><td>(\w*)</td><td>(\w*)</td></tr>""".r

val tableRegEx = """<tr><td>([^/]*)</td><td>([^/]*)</td><td>([^/]*)</td><td>([^/]*)</td><td>([^/]*)</td><td>([^/]*)</td></tr>""".r

for (tableRegEx(name, chinese, math, science, society, health) <- tableRegEx findAllIn tables ) 
yield {
  s"{"name": "${name}", "grades": {"國語": ${chinese}, "數學": ${math}, "自然": ${science}, "社會": ${society}, "健康教育": ${health}}}"
}

